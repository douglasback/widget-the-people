/*! widget-the-people - v0.1.0 - 2013-05-24
* Copyright (c) 2013 Douglas Back;*/(function(t){"use strict";var n,e=[],r=[],i="https://api.whitehouse.gov/v1/petitions.jsonp",u=function(n){n=n||0,t.getJSON(i+"?limit=1000&offset="+n+"&callback=?",function(r){var i=r.metadata.resultset,a=r.results;e=e.concat(a),i.count-n>i.limit?u(i.offset+i.limit+1):t("body").trigger("petitionsLoaded")})},a=function(){r=_.map(e,function(t){var n={};return n.title=t.title,n.id=t.id,n}),n=_.pluck(r,"title"),t("#title-search").typeahead({source:n,minLength:2}),t("body").trigger("autocompleteLoaded")},o=function(){t("#search").on("click",function(n){n.preventDefault();var e,i,u,a=t("#title-search").val(),o=document.location.host;i=_.find(r,function(t){return t.title===a}),u=t(".theme-selector input:checked").val(),u=u?"?theme="+u:"",e='<iframe src="//'+o+"/widget/"+i.id+u+'" style="width: 100%; height: 265px; border: 0;" scrolling="no"></iframe>',t("#generated-widget").val(e),t("#preview-inner").html(e)})};t("#spinner").fadeIn(),u(),o(),t("body").on("petitionsLoaded",a),t("body").on("autocompleteLoaded",function(){t("#spinner").fadeOut()})})(jQuery);